build-image:
  stage: build
  image: gcr.io/cloud-solutions-images/kaniko
  variables:
    SRC_PATH: "./"
  extends:
  script:
    - docker login -u "$CI_REGISTRY_USER" -p "$CI_REGISTRY_PASSWORD" $CI_REGISTRY
    - executor -f `pwd`/${SRC_PATH}/Dockerfile -c `pwd`/${SRC_PATH} --destination="${CI_REGISTRY_IMAGE}:${CI_COMMIT_SHA}"